<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>H∆∞ng Ph√∫ Tennis Open 2 - 2025</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --primary: #0d6efd;
      --success: #28a745;
      --gold: #ffc107;
      --silver: #adb5bd;
      --bronze: #cd7f32;
    }
    body {
      background: linear-gradient(135deg, #f0f8ff 0%, #e3f2fd 100%);
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
    }
    .header {
      background: var(--primary);
      color: white;
      padding: 1rem 0;
      box-shadow: 0 4px 20px rgba(13,110,253,0.25);
    }
    .card {
      border: none;
      border-radius: 1rem;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      transition: transform 0.3s;
    }
    .card:hover { transform: translateY(-5px); }
    .card-header {
      background: var(--success);
      color: white;
      font-weight: 600;
      font-size: 1.1rem;
    }
    .table {
      font-size: 0.95rem;
      margin-bottom: 0;
    }
    .rank-1 { background: linear-gradient(45deg, #ffd700, #ffec8b) !important; font-weight: bold; }
    .rank-2 { background: #f8f9fa !important; }
    .rank-3 { background: #fdfd96 !important; }
    .medal { font-size: 1.2em; }
    .chart-container {
      position: relative;
      height: 220px;
      background: white;
      border-radius: 0 0 1rem 1rem;
    }
    .match-status {
      font-size: 0.8rem;
      padding: 2px 8px;
      border-radius: 12px;
    }
    .status-done { background: #d4edda; color: #155724; }
    .status-pending { background: #fff3cd; color: #856404; }
    .bracket {
      background: white;
      border-radius: 1rem;
      padding: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      margin-top: 30px;
    }
    .team-node {
      background: #e3f2fd;
      border: 2px solid var(--primary);
      border-radius: 12px;
      padding: 10px 15px;
      text-align: center;
      font-weight: 600;
      min-width: 120px;
    }
    .arrow-line {
      height: 4px;
      background: var(--primary);
      position: relative;
    }
    .arrow-line::after {
      content: '';
      position: absolute;
      right: -10px;
      top: -8px;
      border: 10px solid transparent;
      border-left-color: var(--primary);
    }
    .trophy-cup {
      font-size: 4rem;
      color: gold;
      filter: drop-shadow(0 0 10px gold);
    }
    @media (max-width: 768px) {
      .chart-container { height: 200px; }
      .team-node { font-size: 0.9rem; min-width: 100px; }
      .bracket { padding: 15px; }
    }
  </style>
</head>
<body>
  <div class="header text-center">
    <h1>
      <i class="fas fa-trophy text-warning"></i>
      GI·∫¢I TENNIS H∆ØNG PH√ö OPEN 2 - 2025
    </h1>
    <p class="mb-0">Chung k·∫øt: 15/11/2025 | Gala Dinner: 18:00</p>
  </div>

  <div class="container py-4">
    <div class="row g-4">
      <div class="col-12 col-md-6">
        <div class="card">
          <div class="card-header text-center">
            <i class="fas fa-table-tennis"></i> B·∫¢NG A
          </div>
          <div class="table-responsive">
            <table class="table table-hover mb-0">
              <thead>
                <tr>
                  <th>H·∫°ng</th>
                  <th>ƒê·ªôi</th>
                  <th>ƒêi·ªÉm</th>
                  <th>HS</th>
                </tr>
              </thead>
              <tbody id="tableA"></tbody>
            </table>
          </div>
          <div class="chart-container"><canvas id="chartA"></canvas></div>
        </div>
      </div>

      <div class="col-12 col-md-6">
        <div class="card">
          <div class="card-header text-center">
            <i class="fas fa-table-tennis"></i> B·∫¢NG B
          </div>
          <div class="table-responsive">
            <table class="table table-hover mb-0">
              <thead>
                <tr>
                  <th>H·∫°ng</th>
                  <th>ƒê·ªôi</th>
                  <th>ƒêi·ªÉm</th>
                  <th>HS</th>
                </tr>
              </thead>
              <tbody id="tableB"></tbody>
            </table>
          </div>
          <div class="chart-container"><canvas id="chartB"></canvas></div>
        </div>
      </div>
    </div>

    <!-- B·∫¢NG TH√îNG TIN ƒê·∫§U -->
    <div class="row g-4 mt-4">
      <div class="col-12">
        <div class="card">
          <div class="card-header text-center">
            <i class="fas fa-list-alt"></i> TH√îNG TIN ƒê·∫§U V√íNG LO·∫†I
          </div>
          <div class="table-responsive">
            <table class="table table-sm table-hover">
              <thead>
                <tr>
                  <th>B·∫£ng</th>
                  <th>Tr·∫≠n</th>
                  <th>ƒê·ªôi 1</th>
                  <th>ƒê·ªôi 2</th>
                  <th>T·ª∑ s·ªë</th>
                  <th>Th·∫Øng</th>
                  <th>Ng√†y</th>
                  <th>Tr·∫°ng th√°i</th>
                </tr>
              </thead>
              <tbody id="matchAll"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- S∆† ƒê·ªí ƒê·∫§U LO·∫†I -->
    <div class="bracket mt-5">
      <h3 class="text-center mb-4">
        <i class="fas fa-sitemap"></i> S∆† ƒê·ªí ƒê·∫§U LO·∫†I TR·ª∞C TI·∫æP
      </h3>
      <div class="text-center trophy-cup mb-4">
        <i class="fas fa-trophy"></i>
      </div>
      <div class="row justify-content-center">
        <div class="col-12">
          <div class="d-flex justify-content-center align-items-center flex-wrap gap-3">
            <!-- B√°n K·∫øt 1 -->
            <div class="team-node" id="bk1-team1">?</div>
            <div class="arrow-line flex-fill"></div>
            <div class="team-node" id="bk1">B√ÅN K·∫æT 1</div>
            <div class="arrow-line flex-fill"></div>
            <div class="team-node" id="bk1-team2">?</div>
          </div>
        </div>
        <!-- B√°n K·∫øt 2 -->
        <div class="col-12 mt-4">
          <div class="d-flex justify-content-center align-items-center flex-wrap gap-3">
            <div class="team-node" id="bk2-team1">?</div>
            <div class="arrow-line flex-fill"></div>
            <div class="team-node" id="bk2">B√ÅN K·∫æT 2</div>
            <div class="arrow-line flex-fill"></div>
            <div class="team-node" id="bk2-team2">?</div>
          </div>
        </div>
        <!-- Chung K·∫øt -->
        <div class="col-12 mt-4">
          <div class="d-flex justify-content-center align-items-center gap-3">
            <div class="team-node winner" id="final1">TH·∫ÆNG BK1</div>
            <div class="arrow-line" style="width: 100px;"></div>
            <div class="team-node winner" style="background: gold; color: #8b4513; font-size: 1.2em;">
              CHUNG K·∫æT<br>15/11
            </div>
            <div class="arrow-line" style="width: 100px;"></div>
            <div class="team-node winner" id="final2">TH·∫ÆNG BK2</div>
          </div>
        </div>
        <!-- Gi·∫£i Ba -->
        <div class="col-12 mt-4">
          <div class="d-flex justify-content-center gap-3">
            <div class="team-node" style="background: #cd7f32; color: white;" id="third1">THUA BK1</div>
            <div class="team-node" style="background: #cd7f32; color: white;" id="third2">THUA BK2</div>
          </div>
          <div class="text-center mt-2">
            <div class="team-node" style="background: #ffc107; color: black; display: inline-block;">
              GI·∫¢I BA
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR93AGPK4vMw6gkl3t-sGEszF1HNNn7ENFl7mUcQWls7AjsKM6d1Z_ZeQWK8gN3wfYMZRpwqRJRN53N/pub?gid=1305415601&single=true&output=csv';
    const matchUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR93AGPK4vMw6gkl3t-sGEszF1HNNn7ENFl7mUcQWls7AjsKM6d1Z_ZeQWK8gN3wfYMZRpwqRJRN53N/pub?gid=1569100184&single=true&output=csv';

    async function fetchCSV(url) {
      const response = await fetch(url);
      const text = await response.text();
      const lines = text.split('\n').map(l => l.trim());
      const headers = lines[0].split(',').map(h => h.trim());
      const rows = lines.slice(1).filter(l => l);
      return rows.map(line => {
        const values = line.split(',').map(v => v.trim());
        return Object.fromEntries(headers.map((h, i) => [h, values[i] || '']));
      });
    }

    async function loadData() {
      try {
        const ranking = await fetchCSV(sheetUrl);
        const matches = await fetchCSV(matchUrl);

        // X·∫øp h·∫°ng
        const tableA = ranking.filter(r => r.B·∫£ng === 'A');
        const tableB = ranking.filter(r => r.B·∫£ng === 'B');
        renderRanking('tableA', tableA);
        renderRanking('tableB', tableB);

        // Th√¥ng tin ƒë·∫•u
        renderMatches('matchA', matches.filter(m => m.B·∫£ng === 'A'));
        renderMatches('matchB', matches.filter(m => m.B·∫£ng === 'B'));

        // S∆° ƒë·ªì
        updateBracket(tableA, tableB);
      } catch (e) {
        console.error(e);
      }
    }

    function renderRanking(id, data) {
      const tbody = document.getElementById(id);
      tbody.innerHTML = data.map(r => {
        const medal = r['X·∫øp h·∫°ng'] == 1 ? 'ü•á' : r['X·∫øp h·∫°ng'] == 2 ? 'ü•à' : r['X·∫øp h·∫°ng'] == 3 ? 'ü•â' : r['X·∫øp h·∫°ng'];
        return `<tr>
          <td><strong>${medal}</strong></td>
          <td><strong>${r.ƒê·ªôi}</strong></td>
          <td>${r.ƒêi·ªÉm}</td>
          <td>${r['Hi·ªáu s·ªë']}</td>
        </tr>`;
      }).join('');
    }

    function renderMatches(id, data) {
      const tbody = document.getElementById(id);
      tbody.innerHTML = data.map(m => {
        const status = m['Tr·∫°ng Th√°i'] || (m['T·ª∑ s·ªë ƒê·ªôi 1'] ? 'ƒê√£ ƒë·∫•u' : 'Ch·ªØ ƒë·∫•u');
        const statusClass = status === 'ƒê√£ ƒë·∫•u' ? 'status-done' : 'status-pending';
        return `<tr>
          <td>${m.Tr·∫≠n}</td>
          <td>${m['ƒê·ªôi 1']}</td>
          <td>${m['ƒê·ªôi 2']}</td>
          <td>${m['T·ª∑ s·ªë ƒê·ªôi 1'] || '-'}</td>
          <td>${m['T·ª∑ s·ªë ƒê·ªôi 2'] || '-'}</td>
          <td>${m['ƒê·ªôi th·∫Øng'] || '-'}</td>
          <td>${m['Ng√†y ƒë·∫•u'] || '-'}</td>
          <td><span class="match-status ${statusClass}">${status}</span></td>
        </tr>`;
      }).join('');
    }

    function updateBracket(a, b) {
      // a[0] = h·∫°ng 1 A, a[1] = h·∫°ng 2 A, ...
      document.getElementById('nhatA').innerText = a[0].ƒê·ªôi + '\n(Nh·∫•t A)';
      document.getElementById('thu4B').innerText = b[3].ƒê·ªôi + '\n(Th·ª© 4 B)';
      document.getElementById('thu3A').innerText = a[2].ƒê·ªôi + '\n(Th·ª© 3 A)';
      document.getElementById('thu2B').innerText = b[1].ƒê·ªôi + '\n(Th·ª© 2 B)';
      document.getElementById('nhatB').innerText = b[0].ƒê·ªôi + '\n(Nh·∫•t B)';
      document.getElementById('thu4A').innerText = a[3].ƒê·ªôi + '\n(Th·ª© 4 A)';
      document.getElementById('thu3B').innerText = b[2].ƒê·ªôi + '\n(Th·ª© 3 B)';
      document.getElementById('thu2A').innerText = a[1].ƒê·ªôi + '\n(Th·ª© 2 A)';
    }

    loadData();
    // T·ª± ƒë·ªông c·∫≠p nh·∫≠t m·ªói 30 gi√¢y
    setInterval(loadData, 30000);
  </script>
</body>
</html>
